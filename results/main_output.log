/Users/karthikbaga04/Documents/University/cs412/Chicago-311/main.py:30: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df_raw['CREATED_DATE'] = pd.to_datetime(df_raw['CREATED_DATE'])

======================================================================
CHICAGO 311 SERVICE REQUEST RESPONSE TIME PREDICTION
======================================================================

Loading data...
Train size: 3443, Test size: 1557

======================================================================
RUNNING BASELINE METHODS
======================================================================
Baseline_0_Global         MAE: 16.0495, RMSE: 24.8106
Baseline_1_SR_TYPE        MAE: 14.5026, RMSE: 25.7295
Baseline_2_ZIP            MAE: 16.7316, RMSE: 25.5918
Baseline_3_SR_ZIP         MAE: 17.2855, RMSE: 31.2967

======================================================================
RUNNING XGBOOST
======================================================================
XGB_Conservative          MAE: 9.4270, RMSE: 23.9090

======================================================================
RUNNING RANDOM FOREST
======================================================================
RF_Conservative           MAE: 9.5769, RMSE: 23.7649

======================================================================
RUNNING LIGHTGBM ENSEMBLE
======================================================================
Training until validation scores don't improve for 50 rounds
[50]	train's l1: 0.763192	valid's l1: 0.753334
[100]	train's l1: 0.653002	valid's l1: 0.664306
[150]	train's l1: 0.608622	valid's l1: 0.63348
[200]	train's l1: 0.588888	valid's l1: 0.623341
[250]	train's l1: 0.575565	valid's l1: 0.617162
[300]	train's l1: 0.567192	valid's l1: 0.613742
[350]	train's l1: 0.559916	valid's l1: 0.611495
[400]	train's l1: 0.554067	valid's l1: 0.610476
[450]	train's l1: 0.54854	valid's l1: 0.608209
[500]	train's l1: 0.543908	valid's l1: 0.606652
[550]	train's l1: 0.539835	valid's l1: 0.60569
[600]	train's l1: 0.535963	valid's l1: 0.604444
[650]	train's l1: 0.531998	valid's l1: 0.603684
[700]	train's l1: 0.52841	valid's l1: 0.602663
[750]	train's l1: 0.525042	valid's l1: 0.602685
Early stopping, best iteration is:
[725]	train's l1: 0.526886	valid's l1: 0.602251
Training until validation scores don't improve for 50 rounds
[50]	train's l1: 0.753937	valid's l1: 0.743214
[100]	train's l1: 0.636788	valid's l1: 0.646894
[150]	train's l1: 0.598959	valid's l1: 0.623048
[200]	train's l1: 0.583766	valid's l1: 0.615478
[250]	train's l1: 0.574138	valid's l1: 0.611018
[300]	train's l1: 0.566222	valid's l1: 0.608452
[350]	train's l1: 0.559514	valid's l1: 0.606097
[400]	train's l1: 0.554149	valid's l1: 0.604308
[450]	train's l1: 0.548485	valid's l1: 0.602886
[500]	train's l1: 0.543311	valid's l1: 0.601374
[550]	train's l1: 0.539255	valid's l1: 0.600743
[600]	train's l1: 0.535061	valid's l1: 0.599633
[650]	train's l1: 0.531558	valid's l1: 0.59923
[700]	train's l1: 0.528172	valid's l1: 0.598513
[750]	train's l1: 0.525125	valid's l1: 0.598449
[800]	train's l1: 0.522232	valid's l1: 0.598361
[850]	train's l1: 0.519435	valid's l1: 0.598028
[900]	train's l1: 0.516644	valid's l1: 0.597491
[950]	train's l1: 0.514313	valid's l1: 0.596888
[1000]	train's l1: 0.512217	valid's l1: 0.596559
Did not meet early stopping. Best iteration is:
[989]	train's l1: 0.512603	valid's l1: 0.59648
Training until validation scores don't improve for 50 rounds
[50]	train's l1: 0.760111	valid's l1: 0.751254
[100]	train's l1: 0.64154	valid's l1: 0.651893
[150]	train's l1: 0.601046	valid's l1: 0.62755
[200]	train's l1: 0.583354	valid's l1: 0.618856
[250]	train's l1: 0.572995	valid's l1: 0.615036
[300]	train's l1: 0.564708	valid's l1: 0.613124
[350]	train's l1: 0.558261	valid's l1: 0.610613
[400]	train's l1: 0.55204	valid's l1: 0.609755
[450]	train's l1: 0.546649	valid's l1: 0.608252
[500]	train's l1: 0.54235	valid's l1: 0.606565
[550]	train's l1: 0.538607	valid's l1: 0.605342
[600]	train's l1: 0.534777	valid's l1: 0.604611
[650]	train's l1: 0.531521	valid's l1: 0.603865
[700]	train's l1: 0.528077	valid's l1: 0.603259
[750]	train's l1: 0.525516	valid's l1: 0.602546
[800]	train's l1: 0.523064	valid's l1: 0.602271
Early stopping, best iteration is:
[795]	train's l1: 0.523317	valid's l1: 0.6022
Training until validation scores don't improve for 50 rounds
[50]	train's l1: 0.765124	valid's l1: 0.760557
[100]	train's l1: 0.649778	valid's l1: 0.664927
[150]	train's l1: 0.604681	valid's l1: 0.631879
[200]	train's l1: 0.586801	valid's l1: 0.620993
[250]	train's l1: 0.575228	valid's l1: 0.615534
[300]	train's l1: 0.566067	valid's l1: 0.611847
[350]	train's l1: 0.558699	valid's l1: 0.609847
[400]	train's l1: 0.55295	valid's l1: 0.608641
[450]	train's l1: 0.547576	valid's l1: 0.606505
[500]	train's l1: 0.542923	valid's l1: 0.605763
[550]	train's l1: 0.538544	valid's l1: 0.605531
[600]	train's l1: 0.534855	valid's l1: 0.604915
[650]	train's l1: 0.531349	valid's l1: 0.604169
[700]	train's l1: 0.528538	valid's l1: 0.603452
[750]	train's l1: 0.525241	valid's l1: 0.602569
[800]	train's l1: 0.522331	valid's l1: 0.602066
[850]	train's l1: 0.520013	valid's l1: 0.601957
Early stopping, best iteration is:
[835]	train's l1: 0.520656	valid's l1: 0.601912
Training until validation scores don't improve for 50 rounds
[50]	train's l1: 0.754984	valid's l1: 0.740605
[100]	train's l1: 0.636696	valid's l1: 0.643906
[150]	train's l1: 0.600713	valid's l1: 0.621486
[200]	train's l1: 0.584271	valid's l1: 0.6131
[250]	train's l1: 0.573525	valid's l1: 0.610149
[300]	train's l1: 0.565526	valid's l1: 0.608445
[350]	train's l1: 0.558275	valid's l1: 0.605944
[400]	train's l1: 0.55241	valid's l1: 0.605254
[450]	train's l1: 0.546959	valid's l1: 0.603623
[500]	train's l1: 0.54259	valid's l1: 0.602249
[550]	train's l1: 0.538603	valid's l1: 0.601337
[600]	train's l1: 0.535084	valid's l1: 0.600432
[650]	train's l1: 0.531784	valid's l1: 0.599846
[700]	train's l1: 0.528817	valid's l1: 0.598367
[750]	train's l1: 0.525801	valid's l1: 0.597699
[800]	train's l1: 0.523491	valid's l1: 0.59734
[850]	train's l1: 0.521201	valid's l1: 0.596765
[900]	train's l1: 0.519063	valid's l1: 0.59661
[950]	train's l1: 0.516708	valid's l1: 0.596173
[1000]	train's l1: 0.514598	valid's l1: 0.595393
Did not meet early stopping. Best iteration is:
[996]	train's l1: 0.514744	valid's l1: 0.595362
LightGBM_Ensemble         MAE: 10.4363, RMSE: 24.4914

======================================================================
CREATING VISUALIZATION
======================================================================
✓ Visualization saved: final_model_comparison_best.png

======================================================================
FINAL SUMMARY
======================================================================

Model                     MAE (days)      RMSE (days)     R²          
----------------------------------------------------------------------
XGB_Conservative          9.4270          23.9090         0.034328    
RF_Conservative           9.5769          23.7649         0.045934    
LightGBM_Ensemble         10.4363         24.4914         -0.013293   
Baseline_1_SR_TYPE        14.5026         25.7295         -0.118336   
Baseline_0_Global         16.0495         24.8106         -0.039877   
Baseline_2_ZIP            16.7316         25.5918         -0.106390   
Baseline_3_SR_ZIP         17.2855         31.2967         -0.654651   
----------------------------------------------------------------------

★ Best Model: XGB_Conservative
  MAE: 9.4270 days
  RMSE: 23.9090 days
  Improvement over best baseline: 35.0%

======================================================================

✓ Results saved to model_results.csv
✓ All done!

